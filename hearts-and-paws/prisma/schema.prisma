// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id             String  @id @default(uuid())
  clerkId        String  @unique  // Clerk user ID
  email          String  @unique
  firstName      String?
   role        Int?    
  lastName       String?
  profileImage   String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  pets           Pet[]
  adoptions      Adoption[]
  rehomes        Rehome[]
  services       Service[]      // Added for Service provider relationship
  appointments   Appointment[]  // Added for Appointment relationship
}

model Pet {
  id              String  @id @default(uuid())
  ownerId         String  @map("userId")
  owner           User    @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  name            String
  age             Int
  size            String
  gender          String
  breed           String
  colors          String
  shotsUpToDate   Boolean
  microchipped    Boolean
  houseTrained    Boolean
  goodWithDogs    Boolean
  goodWithCats    Boolean
  goodWithKids    Boolean
  purebred        Boolean
  specialNeeds    Boolean
  behavioralIssues Boolean
  addressLine1    String
  addressLine2    String?
  city            String
  postcode        String
  additionalInfo  String?
  images          String[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  adoptions       Adoption[]
  rehomes         Rehome[]
}

model Adoption {
  id                     String @id @default(uuid())
  userId                 String
  user                   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  petId                  String
  pet                    Pet    @relation(fields: [petId], references: [id], onDelete: Cascade)
  addressLine1           String
  addressLine2           String?
  postcode               String
  town                   String
  telephone              String
  hasGarden             Boolean
  homeSituation         String
  householdSetting      String
  activityLevel         String
  homePhotos            String[]
  numAdults             Int
  numChildren           Int
  youngestChildAge      Int
  visitingChildren      Boolean
  visitingChildrenAges  String?
  flatmatesOrLodgers    Boolean
  allergiesToPets       Boolean
  previousPetExperience String
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}

model Rehome {
  id                String  @id @default(uuid())
  userId            String
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  petId             String
  pet               Pet     @relation(fields: [petId], references: [id], onDelete: Cascade)
  reason            String
  durationToKeepPet String
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model Service {
  id          String       @id @default(uuid())
  providerId  String
  provider    User         @relation(fields: [providerId], references: [id], onDelete: Cascade)
  title       String
  description String
  price       Float
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  appointments Appointment[]
}

model Appointment {
  id          String       @id @default(uuid())
  serviceId   String
  service     Service      @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  adopterId   String
  adopter     User         @relation(fields: [adopterId], references: [id], onDelete: Cascade)
  scheduledAt DateTime
  feedback    String?      // Added optional feedback field
  status      String       // e.g., "pending", "confirmed", "completed"
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}